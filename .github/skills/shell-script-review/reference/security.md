### 5. Security (SEC)

**SEC-01: 入力値検証**

Check: ユーザー入力が正規表現・ホワイトリストで検証されているか
Why: 入力無検証でコマンドインジェクション、パストラバーサル、データ破壊
Fix: 入力値正規表現検証、ホワイトリスト、範囲チェック

**SEC-02: コマンドインジェクション対策**

Check: 全変数が`"$var"`で引用符されevalが回避されているか
Why: 変数引用符なし・eval使用で任意コマンド実行、権限昇格、システム侵害
Fix: 全変数`"$var"`引用符、eval回避、配列利用

**SEC-03: パス traversal 対策**

Check: パスがrealpath・正規化され許可ディレクトリ制限があるか
Why: `../`許容でファイルアクセス、データ漏洩、改ざん
Fix: realpath利用、パス正規化、許可ディレクトリ制限

**SEC-04: 一時ファイル mktemp+trap 削除**

Check: 一時ファイルがmktempで作成されtrapで削除されるか
Why: 固定ファイル名・予測可能パスでシンボリックリンク攻撃、情報漏洩
Fix: `mktemp -d`利用、trap削除、セキュアパス

**SEC-05: 権限チェック**

Check: 必要な権限（root等）がチェックされているか
Why: 権限未確認で実行失敗、部分的成功、セキュリティリスク
Fix: `[[ $EUID -eq 0 ]]`確認、適切エラーメッセージ

**SEC-06: ログ機密情報マスク**

Check: パスワード・トークンがログ出力前にマスクされているか
Why: 機密情報ログ出力で認証情報漏洩、監査ログ汚染、セキュリティ侵害
Fix: 機密変数`***`マスク、ログ出力前フィルタ

**SEC-07: 外部コマンド検証**

Check: 外部コマンドが絶対パスまたはcommand -vで検証されているか
Why: PATH環境変数依存でコマンド偽装、マルウェア実行、予期しない動作
Fix: `/usr/bin/`等絶対パス使用、command -v検証

**SEC-08: 環境変数汚染回避**

Check: 環境変数が明示的に初期化されデフォルト値があるか
Why: 継承環境変数信頼で予期しない動作、セキュリティバイパス、データ破損
Fix: 環境変数明示的初期化、デフォルト値設定、検証

**SEC-09: セキュアデフォルト (umask 027)**

Check: umask 027が設定され最小権限原則が適用されているか
Why: デフォルトumaskで情報漏洩、不正アクセス、機密ファイル露出
Fix: umask 027設定、明示的権限設定、最小権限原則
